(this["webpackJsonpchat-app-web"]=this["webpackJsonpchat-app-web"]||[]).push([[0],{209:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){"use strict";a.r(t);a(199);var n=a(0),c=a.n(n),r=a(27),s=a.n(r),o=a(86),i=a(40),l=a(26),j=(a(209),a(166)),u=a(73),b=a(72),p=a(181),d=a.n(p),h=a(195),O=a(25),m=a(43),g=Object(m.b)({hashType:"hashbang"});function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(u.b)(Object(O.a)({router:Object(o.b)(g)},e));return t}var f=a(105),y=a(310),C=a(306),v=a(97),k=a(54),w=a(307),E=a(78),_=a(305),T=a(60),S=a(58),L=a(308),P=a(309),R=a(6),I={labelCol:{span:8},wrapperCol:{span:16}},A={wrapperCol:{offset:8,span:16}},N=function(e){var t=e.form,a=e.isModalVisible,n=e.handleOk,c=e.handleCancel;return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(L.a,{title:"Create Chat Topic",centered:!0,visible:a,onOk:n,onCancel:c,footer:null,children:Object(R.jsx)(C.a,Object(O.a)(Object(O.a)({},I),{},{form:t,onFinish:n,children:Object(R.jsx)(v.a,{align:"middle",justify:"center",children:Object(R.jsxs)(k.a,{span:16,children:[Object(R.jsx)(C.a.Item,{label:"Topic Name",name:"topic",rules:[{required:!0,message:"Please input your topic name!"}],children:Object(R.jsx)(P.a,{})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},A),{},{children:Object(R.jsx)(E.a,{type:"primary",htmlType:"submit",children:"Submit"})}))]})})}))})})},F=a(193),H=a(186),U=a.n(H),q=a(304),M=a(303),D=a(75),V=a.n(D),X="https://chat-app-api-1.herokuapp.com",Q=P.a.TextArea,B={labelCol:{span:8},wrapperCol:{span:16}},G={wrapperCol:{offset:8,span:16}},z=function(){var e=Object(l.g)().slug,t=C.a.useForm(),a=Object(f.a)(t,1)[0],c=Object(n.useState)([]),r=Object(f.a)(c,2),s=r[0],o=r[1];Object(n.useEffect)((function(){U.a.createConsumer("wss://chat-app-api-1.herokuapp.com/cable").subscriptions.create({channel:"MessagesChannel",chatroom_slug:"messages_".concat(e)},{connected:function(){console.log("connected!")},disconnected:function(){console.log("disconnected")},received:function(e){console.log("socket data----------------",e),o((function(t){return[].concat(Object(F.a)(t),[e.message])}))}})}),[e]),Object(n.useEffect)((function(){V.a.get("".concat(X,"/chatrooms/").concat(e,"/messages")).then((function(e){var t=e.data.data;console.log("messages-------, ",t),o(t.messages)})).catch((function(e){console.log("err: ",e.response)}))}),[e]);return Object(R.jsxs)("div",{children:[Object(R.jsxs)("h3",{children:["Chat Room: ",e]}),Object(R.jsx)(q.b,{className:"comment-list",header:"".concat(s.length," replies"),itemLayout:"horizontal",dataSource:s,renderItem:function(e){return Object(R.jsx)("li",{children:Object(R.jsx)(M.a,{actions:e.actions,author:e.user.username,avatar:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",content:e.content,datetime:e.created_at})})}}),Object(R.jsxs)(C.a,Object(O.a)(Object(O.a)({},B),{},{name:"basic",onFinish:function(t){console.log("Success:",t),V.a.post("".concat(X,"/chatrooms/").concat(e,"/messages"),{message:{content:t.content,user_id:2}}).then((function(e){console.log(e),console.log(e.data),a.resetFields()})).catch((function(e){console.log("err: ",e.response)}))},form:a,children:[Object(R.jsx)(C.a.Item,{name:"content",rules:[{required:!0,message:"Please input your message!"}],children:Object(R.jsx)(Q,{rows:4})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},G),{},{children:Object(R.jsx)(E.a,{type:"primary",htmlType:"submit",children:" Submit "})}))]}))]})},J="app/ChatPage/OPEN_MODAL_REQUEST",W="app/ChatPage/CLOSE_MODAL_REQUEST",Y="app/ChatPage/CHAT_REQUEST",K="app/ChatPage/CHAT_SUCCESS",Z="app/ChatPage/CHAT_ERROR",$="app/ChatPage/CHAT_CREATE_REQUEST",ee="app/ChatPage/CHAT_CREATE_SUCCESS",te="app/ChatPage/CHAT_CREATE_ERROR";function ae(e,t){return{type:ee,chatroom:e,message:t}}function ne(e,t){return{type:te,error:e,message:t}}var ce=a(132),re={rooms:[],isLoading:!1,error:{},topic:{},message:"",modalOpen:!1},se=Object(ce.a)((function(e,t){switch(t.type){case Y:e.isLoading=!0;break;case K:e.rooms=t.rooms,e.isLoading=!1;break;case Z:e.error=t.error,e.isLoading=!1;break;case $:e.isLoading=!0,e.topic=t.topic;break;case ee:console.log("action: ",t),e.rooms.push(t.chatroom),e.message=t.message,e.isLoading=!1,e.modalOpen=!1;break;case te:console.log("action: ",t),e.error=t.error,e.message=t.message,e.isLoading=!0;break;case J:e.modalOpen=!0;break;case W:e.modalOpen=!1;break;default:return e}}),re),oe=a(52),ie=a.n(oe),le=a(198),je=a(39),ue=V.a.create(),be="https://chat-app-api-1.herokuapp.com";ue.interceptors.request.use((function(e){var t=localStorage.getItem("token");return e.headers.Authorization="Bearer ".concat(t),e}));var pe=function(e){return V.a.post("".concat(be,"/login"),{user:e}).then((function(e){return e.data})).catch((function(e){return e.response}))},de=function(e){return ue.get("".concat(be,"/chatrooms")).then((function(e){return e.data})).catch((function(e){return e.response}))},he=function(e){return ue.post("".concat(be,"/chatrooms"),{chatroom:e}).then((function(e){return e.data})).catch((function(e){return e.response.data||e.response}))},Oe=function(e){return e.chatroom||re},me=ie.a.mark(fe),ge=ie.a.mark(ye),xe=ie.a.mark(Ce);function fe(){var e,t,a;return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(je.a)(de);case 3:if(e=n.sent,t=e.data,a=e.success,console.log("res login: ",t),!a){n.next=10;break}return n.next=10,Object(je.b)((c=t.rooms,{type:K,rooms:c}));case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("Error => ",n.t0);case 15:case"end":return n.stop()}var c}),me,null,[[0,12]])}function ye(){var e,t,a,n,c;return ie.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(je.c)(Object(S.a)(Oe,(function(e){return e.topic})));case 2:return e=r.sent,r.prev=3,r.next=6,Object(je.a)(he,e);case 6:if(t=r.sent,a=t.data,n=t.success,c=t.message,!n){r.next=16;break}return r.next=13,Object(je.b)(ae(a.chatroom,c));case 13:le.a.info({description:c,placement:"bottomRight"}),r.next=19;break;case 16:return r.next=18,Object(je.b)(ne({},c));case 18:le.a.error({message:c,placement:"bottomRight"});case 19:r.next=27;break;case 21:return r.prev=21,r.t0=r.catch(3),console.log("Error => ",r.t0),r.next=26,Object(je.b)(ne(r.t0,""));case 26:le.a.error({message:r.t0,placement:"bottomRight"});case 27:case"end":return r.stop()}}),ge,null,[[3,21]])}function Ce(){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.d)(Y,fe);case 2:return e.next=4,Object(je.d)($,ye);case 4:case"end":return e.stop()}}),xe)}var ve=y.a.Header,ke=y.a.Content,we="chatroom",Ee=function(){Object(b.b)({key:we,reducer:se}),Object(b.c)({key:we,saga:Ce});var e=Object(i.d)(),t=Object(S.b)({rooms:Object(S.a)(Oe,(function(e){return e.rooms})),isModalVisible:Object(S.a)(Oe,(function(e){return e.modalOpen}))}),a=Object(i.e)(t),c=a.rooms,r=a.isModalVisible,s=Object(l.h)(),o=s.path,j=s.url,u=C.a.useForm(),p=Object(f.a)(u,1)[0];return Object(n.useEffect)((function(){e({type:Y})}),[e]),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(y.a,{children:[Object(R.jsx)(ve,{children:Object(R.jsx)("div",{className:"logo"})}),Object(R.jsx)(ke,{style:{padding:"0 50px",marginTop:64},children:Object(R.jsx)(v.a,{align:"middle",justify:"center",style:{minHeight:"300px"},children:Object(R.jsxs)(k.a,{span:24,children:[Object(R.jsx)(w.a.Title,{children:"Welcome to Chat App"}),Object(R.jsxs)(v.a,{gutter:[16,16],align:"middle",justify:"center",children:[Object(R.jsxs)(k.a,{span:24,children:[Object(R.jsx)("h2",{children:"Chat Topic"}),Object(R.jsx)(E.a,{type:"primary",onClick:function(){return e({type:J})},children:"Create Topic"}),Object(R.jsx)(N,{form:p,isModalVisible:r,handleOk:function(t){return e(function(e){return{type:$,topic:e}}(t))},handleCancel:function(){return e({type:W})}})]}),Object(R.jsx)(k.a,{span:10,children:Object(R.jsx)(_.a,{children:Object(R.jsxs)("ul",{children:[c.length<=0&&Object(R.jsx)("h3",{children:" No topic found "}),c.map((function(e,t){return Object(R.jsx)("li",{children:Object(R.jsx)(T.a,{to:"".concat(j,"/").concat(e.slug),children:e.topic})},t)}))]})})}),Object(R.jsx)(k.a,{span:14,children:Object(R.jsx)(_.a,{children:Object(R.jsxs)(l.d,{children:[Object(R.jsx)(l.b,{exact:!0,path:o,component:function(){return Object(R.jsx)("h3",{children:"Please select a chat topic."})}}),Object(R.jsx)(l.b,{path:"".concat(o,"/:slug"),component:z})]})})})]}),","]})})})]}),Object(R.jsx)(T.a,{to:"/",children:"Go Back"})]})},_e="app/LoginPage/LOGIN_REQUEST",Te="app/LoginPage/LOGIN_SUCCESS",Se="app/LoginPage/LOGIN_ERROR";function Le(e,t){return{type:Te,user:e,token:t}}var Pe={body:{},token:"",isLoading:!1,isLogged:!1,error:{}},Re=Object(ce.a)((function(e,t){switch(t.type){case _e:e.body=t.user,e.isLoading=!0;break;case Te:e.token=t.token,e.user=t.user,e.isLogged=!0,e.isLoading=!1;break;case Se:e.body=t.error,e.isLoading=!1;break;default:return e}}),Pe),Ie=a(36),Ae=function(e){return e.auth||Pe},Ne=ie.a.mark(He),Fe=ie.a.mark(Ue);function He(){var e,t,a;return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(je.c)(Object(S.a)(Ae,(function(e){return e.body})));case 2:return e=n.sent,n.prev=3,n.next=6,Object(je.a)(pe,e);case 6:if(t=n.sent,a=t.data,!t.success){n.next=15;break}return localStorage.setItem("token",a.token),n.next=13,Object(je.b)(Le(a.user,a.token));case 13:return n.next=15,Object(je.b)(Object(Ie.d)("/chat"));case 15:n.next=20;break;case 17:n.prev=17,n.t0=n.catch(3),console.log("Error => ",n.t0);case 20:case"end":return n.stop()}}),Ne,null,[[3,17]])}function Ue(){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.d)(_e,He);case 2:case"end":return e.stop()}}),Fe)}var qe=y.a.Header,Me=y.a.Content,De={labelCol:{span:8},wrapperCol:{span:16}},Ve={wrapperCol:{offset:8,span:16}},Xe="auth",Qe=function(){Object(b.b)({key:Xe,reducer:Re}),Object(b.c)({key:Xe,saga:Ue});var e=Object(i.d)();return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(y.a,{children:[Object(R.jsx)(qe,{children:Object(R.jsx)("div",{className:"logo"})}),Object(R.jsx)(Me,{style:{padding:"0 50px",marginTop:64},children:Object(R.jsx)(v.a,{align:"middle",justify:"center",style:{minHeight:"300px"},children:Object(R.jsxs)(k.a,{span:10,children:[Object(R.jsx)(w.a.Title,{children:"Welcome to Chat App"}),Object(R.jsxs)(C.a,Object(O.a)(Object(O.a)({},De),{},{initialValues:{username:"test",password:"test"},onFinish:function(t){return e(function(e){return{user:e,type:_e}}(t))},children:[Object(R.jsx)(C.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(R.jsx)(P.a,{})}),Object(R.jsx)(C.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(R.jsx)(P.a.Password,{})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},Ve),{},{children:Object(R.jsxs)(w.a.Paragraph,{children:["Don't you have an account? ",Object(R.jsx)(T.a,{to:"/register",children:" Register here"})]})})),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},Ve),{},{children:Object(R.jsx)(E.a,{type:"primary",htmlType:"submit",children:"Login"})}))]}))]})})})]})})},Be=y.a.Header,Ge=y.a.Content,ze={labelCol:{span:8},wrapperCol:{span:16}},Je={wrapperCol:{offset:8,span:16}},We=function(){return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(y.a,{children:[Object(R.jsx)(Be,{children:Object(R.jsx)("div",{className:"logo"})}),Object(R.jsx)(Ge,{style:{padding:"0 50px",marginTop:64},children:Object(R.jsx)(v.a,{align:"middle",justify:"center",style:{minHeight:"300px"},children:Object(R.jsxs)(k.a,{span:18,children:[Object(R.jsx)(w.a.Title,{children:"Welcome to Chat App"}),Object(R.jsxs)(C.a,Object(O.a)(Object(O.a)({},ze),{},{name:"basic",initialValues:{username:"test",password:"test",first_name:"hi",last_name:"there"},onFinish:function(e){console.log("Success:",e),V.a.post("".concat(X,"/signup"),{user:e}).then((function(e){console.log(e),console.log(e.data)})).catch((function(e){console.log("err: ",e.response)}))},children:[Object(R.jsx)(C.a.Item,{label:"First Name",name:"first_name",rules:[{required:!0,message:"Please input your first name!"}],children:Object(R.jsx)(P.a,{})}),Object(R.jsx)(C.a.Item,{label:"Last Name",name:"last_name",rules:[{required:!0,message:"Please input your last name!"}],children:Object(R.jsx)(P.a,{})}),Object(R.jsx)(C.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(R.jsx)(P.a,{})}),Object(R.jsx)(C.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(R.jsx)(P.a.Password,{})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},Je),{},{children:Object(R.jsxs)(w.a.Paragraph,{children:["Already have an account?   ",Object(R.jsx)(T.a,{to:"/",children:" Login here"})]})})),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},Je),{},{children:Object(R.jsx)(E.a,{type:"primary",htmlType:"submit",children:"Register"})}))]}))]})})})]})})},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=u.c,n={};"object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&(a=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}));var c=Object(h.a)(n),r=c.run,s=[c,Object(j.a)(t),d.a],o=[u.a.apply(void 0,s),Object(b.a)({createReducer:x,runSaga:r})],i=Object(u.d)(x(),e,a.apply(void 0,o));return i}(function(){try{var e=localStorage.getItem("bankapp_state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),g);var Ke=function(){return Object(R.jsx)(i.a,{store:Ye,children:Object(R.jsx)(o.a,{history:g,children:Object(R.jsxs)(l.d,{children:[Object(R.jsx)(l.b,{exact:!0,path:"/login",component:Qe}),Object(R.jsx)(l.b,{exact:!0,path:"/register",component:We}),Object(R.jsx)(l.b,{path:"/chat",component:Ee}),Object(R.jsx)(l.a,{to:"/login",from:"/"}),Object(R.jsx)(l.b,{path:"*",exact:!0,component:Qe})]})})})},Ze=(a(300),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,311)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))});s.a.render(Object(R.jsx)(c.a.StrictMode,{children:Object(R.jsx)(Ke,{})}),document.getElementById("root")),Ze()}},[[301,1,2]]]);
//# sourceMappingURL=main.4396902f.chunk.js.map