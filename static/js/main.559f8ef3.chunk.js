(this["webpackJsonpchat-app-web"]=this["webpackJsonpchat-app-web"]||[]).push([[0],{209:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){"use strict";a.r(t);a(199);var n=a(0),c=a.n(n),s=a(27),r=a.n(s),o=a(76),i=a(50),l=a(26),j=(a(209),a(167)),u=a(73),b=a(72),d=a(182),p=a.n(d),h=a(195),O=a(25),m=a(41),g=Object(m.a)({basename:"/chat-app-web"});function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(u.b)(Object(O.a)({router:Object(o.b)(g)},e));return t}var f=a(134),y=a(83),v=a(310),C=a(306),w=a(198),k=a(97),L=a(53),_=a(307),S=a(78),I=a(305),P=a(55),E=a.n(P),T=a(60),N=a(308),F=a(309),R=a(6),q={labelCol:{span:8},wrapperCol:{span:16}},U={wrapperCol:{offset:8,span:16}},D=function(e){var t=e.form,a=e.isModalVisible,n=e.handleOk,c=e.handleCancel;return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(N.a,{title:"Create Chat Topic",centered:!0,visible:a,onOk:n,onCancel:c,footer:null,children:Object(R.jsx)(C.a,Object(O.a)(Object(O.a)({},q),{},{form:t,onFinish:n,children:Object(R.jsx)(k.a,{align:"middle",justify:"center",children:Object(R.jsxs)(L.a,{span:16,children:[Object(R.jsx)(C.a.Item,{label:"Topic Name",name:"topic",rules:[{required:!0,message:"Please input your topic name!"}],children:Object(R.jsx)(F.a,{})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},U),{},{children:Object(R.jsx)(S.a,{type:"primary",htmlType:"submit",children:"Submit"})}))]})})}))})})},G="https://chat-app-api-1.herokuapp.com",H=a(187),V=a.n(H),A=a(304),M=a(303),X=F.a.TextArea,B={labelCol:{span:8},wrapperCol:{span:16}},J={wrapperCol:{offset:8,span:16}},W=function(){var e=Object(l.g)().slug,t=C.a.useForm(),a=Object(y.a)(t,1)[0],c=Object(n.useState)([]),s=Object(y.a)(c,2),r=s[0],o=s[1];Object(n.useEffect)((function(){V.a.createConsumer("ws://chat-app-api-1.herokuapp.com/cable").subscriptions.create({channel:"MessagesChannel",chatroom_slug:"messages_".concat(e)},{connected:function(){console.log("connected!")},disconnected:function(){console.log("disconnected")},received:function(e){console.log("socket data----------------",e),o((function(t){return[].concat(Object(f.a)(t),[e.message])}))}})}),[e]),Object(n.useEffect)((function(){E.a.get("".concat(G,"/chatrooms/").concat(e,"/messages")).then((function(e){var t=e.data.data;console.log("messages-------, ",t),o(t.messages)})).catch((function(e){console.log("err: ",e.response)}))}),[e]);return Object(R.jsxs)("div",{children:[Object(R.jsxs)("h3",{children:["Chat Room: ",e]}),Object(R.jsx)(A.b,{className:"comment-list",header:"".concat(r.length," replies"),itemLayout:"horizontal",dataSource:r,renderItem:function(e){return Object(R.jsx)("li",{children:Object(R.jsx)(M.a,{actions:e.actions,author:e.user.username,avatar:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",content:e.content,datetime:e.created_at})})}}),Object(R.jsxs)(C.a,Object(O.a)(Object(O.a)({},B),{},{name:"basic",onFinish:function(t){console.log("Success:",t),E.a.post("".concat(G,"/chatrooms/").concat(e,"/messages"),{message:{content:t.content,user_id:2}}).then((function(e){console.log(e),console.log(e.data),a.resetFields()})).catch((function(e){console.log("err: ",e.response)}))},form:a,children:[Object(R.jsx)(C.a.Item,{name:"content",rules:[{required:!0,message:"Please input your message!"}],children:Object(R.jsx)(X,{rows:4})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},J),{},{children:Object(R.jsx)(S.a,{type:"primary",htmlType:"submit",children:" Submit "})}))]}))]})},z=a(131),Q="app/ChatPage/LOGIN_REQUEST",Y="app/ChatPage/LOGIN_SUCCESS",K="app/ChatPage/LOGIN_ERROR";function Z(e,t){return{type:Y,user:e,token:t}}var $={body:{},token:"",isLoading:!1,isLogged:!1,error:{}},ee=Object(z.a)((function(e,t){switch(t.type){case Q:e.body=t.user,e.isLoading=!0;break;case Y:e.token=t.token,e.user=t.user,e.isLogged=!0,e.isLoading=!1;break;case K:e.body=t.error,e.isLoading=!1;break;default:return e}}),$),te=a(59),ae=a.n(te),ne=a(36),ce=a(51),se=function(e){return E.a.post("".concat("https://chat-app-api-1.herokuapp.com","/login"),{user:e}).then((function(e){return e.data})).catch((function(e){return e.response}))},re=a(132),oe=function(e){return e.auth||$},ie=ae.a.mark(je),le=ae.a.mark(ue);function je(){var e,t,a;return ae.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ce.c)(Object(re.a)(oe,(function(e){return e.body})));case 2:return e=n.sent,console.log("user on saga: ",e),n.prev=4,n.next=7,Object(ce.a)(se,e);case 7:if(t=n.sent,a=t.data,console.log("res login: ",a),!a.success){n.next=15;break}return n.next=13,Object(ce.b)(Z(a.user,a.token));case 13:return n.next=15,Object(ce.b)(Object(ne.d)("/chat"));case 15:n.next=20;break;case 17:n.prev=17,n.t0=n.catch(4),console.log("Error => ",n.t0);case 20:case"end":return n.stop()}}),ie,null,[[4,17]])}function ue(){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ce.d)(Q,je);case 2:case"end":return e.stop()}}),le)}var be=v.a.Header,de=v.a.Content,pe="chat",he=function(){Object(b.b)({key:pe,reducer:ee}),Object(b.c)({key:pe,saga:ue});var e=Object(l.h)(),t=e.path,a=e.url,c=Object(n.useState)([]),s=Object(y.a)(c,2),r=s[0],o=s[1],i=C.a.useForm(),j=Object(y.a)(i,1)[0],u=Object(n.useState)(!1),d=Object(y.a)(u,2),p=d[0],h=d[1];Object(n.useEffect)((function(){E.a.get("".concat(G,"/chatrooms")).then((function(e){var t=e.data.data;o(t.rooms)})).catch((function(e){console.log("err: ",e.response)}))}),[]);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(v.a,{children:[Object(R.jsx)(be,{children:Object(R.jsx)("div",{className:"logo"})}),Object(R.jsx)(de,{style:{padding:"0 50px",marginTop:64},children:Object(R.jsx)(k.a,{align:"middle",justify:"center",style:{minHeight:"300px"},children:Object(R.jsxs)(L.a,{span:24,children:[Object(R.jsx)(_.a.Title,{children:"Welcome to Chat App"}),Object(R.jsxs)(k.a,{gutter:[16,16],align:"middle",justify:"center",children:[Object(R.jsxs)(L.a,{span:24,children:[Object(R.jsx)("h2",{children:"Chat Topic"}),Object(R.jsx)(S.a,{type:"primary",onClick:function(){h(!0)},children:"Create Topic"}),Object(R.jsx)(D,{form:j,isModalVisible:p,handleOk:function(e){E.a.post("".concat(G,"/chatrooms"),{chatroom:e}).then((function(e){o((function(t){return[].concat(Object(f.a)(t),[e.data.data.chatroom])})),h(!1),j.resetFields(),w.a.info({description:"Success!",placement:"bottomRight"})})).catch((function(e){w.a.error({message:e.response.data.message,placement:"bottomRight"})}))},handleCancel:function(){h(!1)}})]}),Object(R.jsx)(L.a,{span:10,children:Object(R.jsx)(I.a,{children:Object(R.jsxs)("ul",{children:[r.length<=0&&Object(R.jsx)("h3",{children:" No topic found "}),r.map((function(e,t){return Object(R.jsx)("li",{children:Object(R.jsx)(T.a,{to:"".concat(a,"/").concat(e.slug),children:e.topic})},t)}))]})})}),Object(R.jsx)(L.a,{span:14,children:Object(R.jsx)(I.a,{children:Object(R.jsxs)(l.d,{children:[Object(R.jsx)(l.b,{exact:!0,path:t,component:function(){return Object(R.jsx)("h3",{children:"Please select a chat topic."})}}),Object(R.jsx)(l.b,{path:"".concat(t,"/:slug"),component:W})]})})})]}),","]})})})]}),Object(R.jsx)(T.a,{to:"/",children:"Go Back"})]})},Oe="app/LoginPage/LOGIN_REQUEST",me="app/LoginPage/LOGIN_SUCCESS",ge="app/LoginPage/LOGIN_ERROR";function xe(e,t){return{type:me,user:e,token:t}}var fe={body:{},token:"",isLoading:!1,isLogged:!1,error:{}},ye=Object(z.a)((function(e,t){switch(t.type){case Oe:e.body=t.user,e.isLoading=!0;break;case me:e.token=t.token,e.user=t.user,e.isLogged=!0,e.isLoading=!1;break;case ge:e.body=t.error,e.isLoading=!1;break;default:return e}}),fe),ve=function(e){return e.auth||fe},Ce=ae.a.mark(ke),we=ae.a.mark(Le);function ke(){var e,t,a,n;return ae.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(ce.c)(Object(re.a)(ve,(function(e){return e.body})));case 2:return e=c.sent,console.log("user on saga: ",e),c.prev=4,c.next=7,Object(ce.a)(se,e);case 7:if(t=c.sent,a=t.data,n=t.success,console.log("res login: ",a),!n){c.next=16;break}return c.next=14,Object(ce.b)(xe(a.user,a.token));case 14:return c.next=16,Object(ce.b)(Object(ne.d)("/chat"));case 16:c.next=21;break;case 18:c.prev=18,c.t0=c.catch(4),console.log("Error => ",c.t0);case 21:case"end":return c.stop()}}),Ce,null,[[4,18]])}function Le(){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ce.d)(Oe,ke);case 2:case"end":return e.stop()}}),we)}var _e=v.a.Header,Se=v.a.Content,Ie={labelCol:{span:8},wrapperCol:{span:16}},Pe={wrapperCol:{offset:8,span:16}},Ee="auth",Te=function(){Object(b.b)({key:Ee,reducer:ye}),Object(b.c)({key:Ee,saga:Le});var e=Object(i.d)();return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(v.a,{children:[Object(R.jsx)(_e,{children:Object(R.jsx)("div",{className:"logo"})}),Object(R.jsx)(Se,{style:{padding:"0 50px",marginTop:64},children:Object(R.jsx)(k.a,{align:"middle",justify:"center",style:{minHeight:"300px"},children:Object(R.jsxs)(L.a,{span:10,children:[Object(R.jsx)(_.a.Title,{children:"Welcome to Chat App"}),Object(R.jsxs)(C.a,Object(O.a)(Object(O.a)({},Ie),{},{initialValues:{username:"test",password:"test"},onFinish:function(t){return e(function(e){return{user:e,type:Oe}}(t))},children:[Object(R.jsx)(C.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(R.jsx)(F.a,{})}),Object(R.jsx)(C.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(R.jsx)(F.a.Password,{})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},Pe),{},{children:Object(R.jsxs)(_.a.Paragraph,{children:["Don't you have an account? ",Object(R.jsx)(T.a,{to:"/register",children:" Register here"})]})})),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},Pe),{},{children:Object(R.jsx)(S.a,{type:"primary",htmlType:"submit",children:"Login"})}))]}))]})})})]})})},Ne=v.a.Header,Fe=v.a.Content,Re={labelCol:{span:8},wrapperCol:{span:16}},qe={wrapperCol:{offset:8,span:16}},Ue=function(){return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(v.a,{children:[Object(R.jsx)(Ne,{children:Object(R.jsx)("div",{className:"logo"})}),Object(R.jsx)(Fe,{style:{padding:"0 50px",marginTop:64},children:Object(R.jsx)(k.a,{align:"middle",justify:"center",style:{minHeight:"300px"},children:Object(R.jsxs)(L.a,{span:18,children:[Object(R.jsx)(_.a.Title,{children:"Welcome to Chat App"}),Object(R.jsxs)(C.a,Object(O.a)(Object(O.a)({},Re),{},{name:"basic",initialValues:{username:"test",password:"test",first_name:"hi",last_name:"there"},onFinish:function(e){console.log("Success:",e),E.a.post("".concat(G,"/signup"),{user:e}).then((function(e){console.log(e),console.log(e.data)})).catch((function(e){console.log("err: ",e.response)}))},children:[Object(R.jsx)(C.a.Item,{label:"First Name",name:"first_name",rules:[{required:!0,message:"Please input your first name!"}],children:Object(R.jsx)(F.a,{})}),Object(R.jsx)(C.a.Item,{label:"Last Name",name:"last_name",rules:[{required:!0,message:"Please input your last name!"}],children:Object(R.jsx)(F.a,{})}),Object(R.jsx)(C.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(R.jsx)(F.a,{})}),Object(R.jsx)(C.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(R.jsx)(F.a.Password,{})}),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},qe),{},{children:Object(R.jsxs)(_.a.Paragraph,{children:["Already have an account?   ",Object(R.jsx)(T.a,{to:"/",children:" Login here"})]})})),Object(R.jsx)(C.a.Item,Object(O.a)(Object(O.a)({},qe),{},{children:Object(R.jsx)(S.a,{type:"primary",htmlType:"submit",children:"Register"})}))]}))]})})})]})})},De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=u.c,n={};"object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&(a=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}));var c=Object(h.a)(n),s=c.run,r=[c,Object(j.a)(t),p.a],o=[u.a.apply(void 0,r),Object(b.a)({createReducer:x,runSaga:s})],i=Object(u.d)(x(),e,a.apply(void 0,o));return i}(function(){try{var e=localStorage.getItem("bankapp_state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),g);var Ge=function(){return Object(R.jsx)(i.a,{store:De,children:Object(R.jsx)(o.a,{history:g,children:Object(R.jsxs)(l.d,{children:[Object(R.jsx)(l.b,{exact:!0,path:"/login",component:Te}),Object(R.jsx)(l.b,{exact:!0,path:"/register",component:Ue}),Object(R.jsx)(l.b,{path:"/chat",component:he}),Object(R.jsx)(l.a,{to:"/login",from:"/"}),Object(R.jsx)(l.b,{path:"*",exact:!0,component:Te})]})})})},He=(a(300),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,311)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),s(e),r(e)}))});r.a.render(Object(R.jsx)(c.a.StrictMode,{children:Object(R.jsx)(Ge,{})}),document.getElementById("root")),He()}},[[301,1,2]]]);
//# sourceMappingURL=main.559f8ef3.chunk.js.map